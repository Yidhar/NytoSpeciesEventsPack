namespace = gf_nyto_weapons
# This = owner of fleet 1
# From = owner of fleet 2
# FromFrom = fleet 1
# FromFromFrom = fleet 2
country_event = {
	id = gf_nyto_weapons.0
	is_triggered_only = yes
	hide_window = yes
	trigger = {
		fromfrom = { owner = { is_invisable_faction = no } }
	}
	immediate = {
		fromfrom = { 
			if ={
				limit = {
					owner =  {is_invisable_faction = no }
				}
			}
			GF_nyto_weapons_system = yes 
		}
		#脚本初始化
	}
}

#杀人书
country_event = {
	id = gf_nyto_weapons.1
	hide_window = yes
	trigger = {
		fromfrom = {
			OR = {
				has_component = GF_Nyto_m_weapon1
				has_component = GF_Nyto_s_weapon1
				has_component = GF_Nyto_m_weapon1_dc
				has_component = GF_Nyto_s_weapon1_dc
			}		
		}
	}
	is_triggered_only = yes
	immediate = {
		fromfrom = {		
			fleet = {
				remove_modifier = gfnyto_ms_weapons1
				change_variable = { which = GF_nyto_kill_num value = 1 }
				add_modifier = { modifier = gfnyto_ms_weapons1 multiplier = GF_nyto_kill_num days = -1}
			}		
		}
	}
}

#浴血
country_event = {
	id = gf_nyto_weapons.10001
	hide_window = yes
	trigger = {
		fromfromfrom.fleet= {
			has_fleet_flag = GF_Nyto_T_weapon1_flag
		}
	}
	is_triggered_only = yes
	immediate = {
		fromfromfrom.fleet = {
			change_variable = {
				which = GF_nyto_t_weapon_dsnm
				value = 1
			}
			remove_modifier = GF_nyto_t_weapon
			add_modifier = {
				modifier = GF_nyto_t_weapon
				multiplier = GF_nyto_t_weapon_dsnm
			}
		}
	}
}

###############克莱因
fleet_event = {
	id = gf_nyto_weapons.11
	is_triggered_only = yes
	hide_window = yes
	immediate = {
		
	}
}

#引导信标
# country_event = {
# 	id = gf_nyto_weapons.12
# 	hide_window = yes
# 	is_triggered_only = yes
# 	immediate = {
# 		every_owned_megastructure = {
# 			limit = {
# 				OR = {
# 					is_megastructure_type = GFnyto_beacon_weapon_02
# 					is_megastructure_type = GFnyto_beacon_weapon_03
# 				}				
# 			}
# 			event_target:is_Gfnyto_command_ship= {
# 				change_variable = {
# 					which = has_GFnyto_beacon_weapon_02
# 					value = 1
# 				}
# 			}
# 			if = {
# 				limit = {
# 					is_megastructure_type = GFnyto_beacon_weapon_02					
# 				}
# 				delete_megastructure = this
# 				solar_system = {
# 					spawn_megastructure = {
# 						name = "超视界支援武器节点 ：激活"
# 						type = GFnyto_beacon_weapon_03
# 						owner = root
# 						coords_from = system_star			
# 					}
# 				}
# 			}						
# 		}
# 		event_target:is_Gfnyto_command_ship = {
# 			GF_nyto_beacon_weapon_damage_lock =yes
# 			remove_modifier = GF_nyto_beacon_count_buff
# 			add_modifier = {
# 				modifier = GF_nyto_beacon_count_buff
# 				multiplier = GF_nyto_beacon_damag_lv
# 			}
# 		}
# 	}
# }

# country_event = {
# 	id = gf_nyto_weapons.13
# 	hide_window = yes
# 	is_triggered_only = yes
# 	trigger = {
# 		NOT = {
# 			any_owned_ship = {
# 				is_ship_size = GFnyto_Command_ship
# 				is_in_combat = yes
# 			}
# 		}		
# 	}
# 	immediate = {
# 		every_owned_megastructure = {
# 			limit = {
# 				is_megastructure_type = GFnyto_beacon_weapon_03
# 			}
# 			solar_system = {
# 				spawn_megastructure = {
# 					name = "超视界支援武器节点 ：待机"
# 					type = GFnyto_beacon_weapon_02
# 					owner = root
# 					coords_from = prev					
# 				}
# 			}			
# 			delete_megastructure = this
# 		}
# 	}
# }

# event = {
# 	id = gf_nyto_weapons.14
# 	hide_window = yes
# 	is_triggered_only = yes
# 	trigger = {
# 		from = {
# 			is_megastructure_type = GFnyto_beacon_weapon_03
# 		}
# 	}
# 	immediate = {
# 		from.solar_system = {
# 			spawn_megastructure = {
# 				name = "超视界支援武器节点 ：待机"
# 				type = GFnyto_beacon_weapon_02
# 				owner = root
# 				coords_from = prev.from					
# 			}			
# 		}
# 		from = {
# 			delete_megastructure = this
# 		}
# 	}
# }

# event = {
# 	id = gf_nyto_weapons.15
# 	hide_window = yes
# 	is_triggered_only = yes
# 	trigger = {
# 		from = {
# 			is_megastructure_type = GFnyto_beacon_weapon_03
# 		}
# 	}
# 	immediate = {		
# 		spawn_megastructure = {
# 			name = "超视界支援武器节点 ：待机"
# 			type = GFnyto_beacon_weapon_02
# 			owner = root
# 			coords_from = from				
# 		}					
# 		from = {
# 			delete_megastructure = this
# 		}
# 	}
# }

########通用日检##########
	# ship_event = {
	# 	id = gf_nyto_weapons.8001
	# 	is_triggered_only = yes
	# 	hide_window = yes
	# 	trigger = { owner = { is_kuat_faction_empire = no } }
	# 	immediate = {
	# 		if = {
	# 			limit = { is_in_combat = yes }
	# 			change_variable = { which = Gfnyto_combat_days value = 1 }
	# 			#终末辉光
	# 			if = {
	# 				limit = { fleet = { has_fleet_flag = has_GF_Nyto_T_weapon2 }  }
	# 				set_variable = {
	# 					which = Gf_nyto_fire_rate_mult
	# 					value = 5
	# 				}
	# 			}
	# 			if = {
	# 				limit = { 
	# 					fleet = { has_fleet_flag = has_GF_Nyto_T_weapon2 }
	# 					check_variable_arithmetic = { modulo = Gf_nyto_fire_rate_mult which = Gfnyto_combat_days value = 0 }
	# 				}
	# 				divide_variable = {
	# 					which = Gf_nyto_fire_rate_mult
	# 					value = moifier:weapon_type_energy_weapon_fire_rate_mult
	# 				}
	# 				change_variable = { which = GF_Nyto_T_weapon2_fire_num value = 1 }
	# 				set_variable = {
	# 					which = GF_Nyto_T_weapon2_damag_mult
	# 					value = GF_Nyto_T_weapon2_fire_num
	# 				}									
	# 				multiply_variable = {
	# 					which = GF_Nyto_T_weapon2_damag_mult
	# 					value = GF_Nyto_T_weapon2_fire_num
	# 				}	
	# 				if = {
	# 					limit = { 
	# 						check_variable = {
	# 							which = GF_Nyto_T_weapon2_damag_mult
	# 							value > 200
	# 						}
	# 					}
	# 					set_variable = {
	# 						which = GF_Nyto_T_weapon2_damag_mult
	# 						value = 200
	# 					}
	# 				}			
	# 				remove_modifier = GF_nyto_T_weapon2_damgabuff
	# 				add_modifier = {
	# 					modifier = GF_nyto_T_weapon2_damgabuff
	# 					multiplier = GF_Nyto_T_weapon2_damag_mult
	# 				}												
	# 			}
	# 			#圣歌风琴攻速up
	# 			if = {
	# 				limit = { has_component = GF_Nyto_l_weapon2	}
	# 				export_modifier_to_variable = {
	# 					modifier = weapon_type_son_weapon_fire_rate_mult
	# 					variable = GF_nyto_l_weapon2_soon_mult
	# 				}	
	# 				set_variable = {
	# 					which = GF_nyto_l_weapon2_soon_mult
	# 					value = 1
	# 				}
	# 				multiply_variable = {
	# 					which = GF_nyto_l_weapon2_soon_mult
	# 					value = Gfnyto_combat_days
	# 				}
	# 				multiply_variable = {
	# 					which = GF_nyto_l_weapon2_soon_mult
	# 					value = Gfnyto_combat_days
	# 				} 坏了 看不懂之前在干嘛了
	# 				if = {
	# 					limit = {
	# 						check_variable = {
	# 							which = GF_nyto_l_weapon2_soon_mult
	# 							value > 100000000
	# 						}
	# 					}
	# 					set_variable = {
	# 						which = GF_nyto_l_weapon2_soon_mult
	# 						value = 100000000
	# 					}
	# 				}
	# 				remove_modifier = GF_nyto_l_weapon2_soon
	# 				add_modifier = {
	# 					modifier = GF_nyto_l_weapon2_soon
	# 					multiplier = GF_nyto_l_weapon2_soon_mult
	# 				}													
	# 			}
	# 			#花舞沉默
	# 			if = {
	# 				limit = {
	# 					fleet = { has_fleet_flag = GF_Nyto_p_weapon2_system }
	# 					check_variable_arithmetic = { modulo = 5 which = Gfnyto_combat_days value = 0 }
	# 				}
	# 				add_modifier = { modifier = GF_nyto_p_weapon_system days = 2 }
	# 			}
	# 			#护盾效果  盾穿
	# 			if = {
	# 				limit = {
	# 					fleet = { has_fleet_flag = GFnyto_shiled_system_LV3_fleet }
	# 					NOT = { check_modifier_value = { modifier = ship_shield_penetration_mult value = -1 } }
	# 				}
	# 				remove_modifier = gfnyto_hudun
	# 				export_modifier_to_variable = {
	# 					modifier = ship_shield_penetration_mult
	# 					variable = GFnyto_shield_p
	# 				}
	# 				change_variable = { which = GFnyto_shield_p value = 1 }
	# 				add_modifier = { modifier = gfnyto_hudun multiplier = GFnyto_shield_p }
	# 				clear_variable = GFnyto_shield_p
	# 			}
	# 			else_if = {
	# 				limit = {
	# 					fleet = { has_fleet_flag = GFnyto_shiled_system_LV2_fleet }
	# 					NOT = { check_modifier_value = { modifier = ship_shield_penetration_mult value = -0.8 } }
	# 				}
	# 				remove_modifier = gfnyto_hudun
	# 				export_modifier_to_variable = {
	# 					modifier = ship_shield_penetration_mult
	# 					variable = GFnyto_shield_p
	# 				}
	# 				change_variable = { which = GFnyto_shield_p value = 0.8 }
	# 				add_modifier = {
	# 					modifier = gfnyto_hudun
	# 					multiplier = GFnyto_shield_p
	# 				}
	# 				clear_variable = GFnyto_shield_p
	# 			}
	# 			else_if = {
	# 				limit = {
	# 					fleet = { has_fleet_flag = GFnyto_shiled_system_LV1_fleet }
	# 					NOT = { check_modifier_value = { modifier = ship_shield_penetration_mult value = -0.6 } }
	# 				}
	# 				remove_modifier = gfnyto_hudun
	# 				export_modifier_to_variable = {
	# 					modifier = ship_shield_penetration_mult
	# 					variable = GFnyto_shield_p
	# 				}
	# 				change_variable = {
	# 					which = GFnyto_shield_p
	# 					value = 0.6
	# 				}
	# 				add_modifier = {
	# 					modifier = gfnyto_hudun
	# 					multiplier = GFnyto_shield_p
	# 				}
	# 				clear_variable = GFnyto_shield_p
	# 			}	#盾穿end
	# 			#动能武器伤害debuff
	# 			if = {
	# 				limit = {
	# 					fleet = { has_fleet_flag = GFnyto_shiled_system_LV3_fleet }
	# 					NOT = { check_modifier_value = { modifier = weapon_type_kinetic_weapon_damage_mult value = -0.9 } }					
	# 				}
	# 				export_modifier_to_variable = {
	# 					modifier = weapon_type_kinetic_weapon_damage_mult
	# 					variable = GFnyto_shield_system_weapon_debuff
	# 				}
	# 				change_variable = {
	# 					which = GFnyto_shield_system_weapon_debuff
	# 					value = 0.9
	# 				}
	# 				add_modifier = {
	# 					modifier = gfnyto_shield_system_sheil_debuff
	# 					multiplier = GFnyto_shield_system_weapon_debuff
	# 				}
	# 				clear_variable = GFnyto_shield_system_weapon_debuff
	# 			}
	# 			else_if = {
	# 				limit = {
	# 					fleet = { has_fleet_flag = GFnyto_shiled_system_LV2_fleet }
	# 					NOT = { check_modifier_value = { modifier = weapon_type_kinetic_weapon_damage_mult value = -0.8 } }					
	# 				}
	# 				export_modifier_to_variable = {
	# 					modifier = weapon_type_kinetic_weapon_damage_mult
	# 					variable = GFnyto_shield_system_weapon_debuff
	# 				}
	# 				change_variable = {
	# 					which = GFnyto_shield_system_weapon_debuff
	# 					value = 0.8
	# 				}
	# 				add_modifier = {
	# 					modifier = gfnyto_shield_system_sheil_debuff
	# 					multiplier = GFnyto_shield_system_weapon_debuff
	# 				}
	# 				clear_variable = GFnyto_shield_system_weapon_debuff
	# 			}
	# 			else_if = {
	# 				limit = {
	# 					fleet = {
	# 						has_fleet_flag = GFnyto_shiled_system_LV1_fleet
	# 					}
	# 					NOT = { check_modifier_value = { modifier = weapon_type_kinetic_weapon_damage_mult value = -0.6 } }					
	# 				}
	# 				export_modifier_to_variable = {
	# 					modifier = weapon_type_kinetic_weapon_damage_mult
	# 					variable = GFnyto_shield_system_weapon_debuff
	# 				}
	# 				change_variable = {
	# 					which = GFnyto_shield_system_weapon_debuff
	# 					value = 0.6
	# 				}
	# 				add_modifier = {
	# 					modifier = gfnyto_shield_system_sheil_debuff
	# 					multiplier = GFnyto_shield_system_weapon_debuff
	# 				}
	# 				clear_variable = GFnyto_shield_system_weapon_debuff
	# 			}		
	# 			#指挥舰伤害锁
	# 			if = {
	# 				limit = {  has_ship_flag = is_Gfnyto_command_ship  }
	# 				GF_nyto_beacon_weapon_damage_lock = yes
	# 				remove_modifier = GF_nyto_beacon_count_buff
	# 				add_modifier = {
	# 					modifier = GF_nyto_beacon_count_buff
	# 					multiplier = GF_nyto_beacon_damag_lv
	# 				}
	# 			}
	# 			#aoe动画
	# 			# if = {
	# 			# 	limit = { 
	# 			# 		fleet = { has_fleet_flag = has_GF_Nyto_T_weapon1 }
	# 			# 		check_variable_arithmetic = { modulo = 15 which = Gfnyto_combat_days value = 0 }
	# 			# 	}				
	# 			# 	create_ambient_object = { 	type = GF_nyto_aoe_object location = event_target:host_fleet  }				
	# 			# 	remove_modifier = GF_nyto_aoe_weapon
	# 			# 	add_modifier = { modifier = GF_nyto_aoe_weapon days = 2 }
	# 			# }
	# 			ship_event = { id = gf_nyto_weapons.8001 days = 1 }
	# 		}
	# 		if = {
	# 			limit = { is_in_combat = no }
	# 			owner = {
	# 				if = {
	# 					limit = {
	# 						has_country_flag = is_open_fire_beacon
	# 					}
	# 					remove_country_flag = is_open_fire_beacon
	# 					country_event = {
	# 						id = gf_nyto_weapons.13
	# 						days = 1
	# 					}
	# 				}				
	# 			}
	# 			clear_variable = Gfnyto_combat_days
	# 			clear_variable = GF_Nyto_T_weapon2_fire_num		
	# 			clear_variable = GF_Nyto_T_weapon2_damag_mult	
	# 			clear_variable = GF_nyto_l_weapon2_soon_mult
	# 			clear_variable = GF_nyto_damag
	# 			clear_variable = has_GFnyto_beacon_weapon_02
	# 			clear_variable = GF_nyto_beacon_damag_lv
	# 			fleet = {
	# 				remove_fleet_flag = GF_Nyto_p_weapon2_system
	# 				remove_fleet_flag = GFnyto_shiled_system_LV3_fleet
	# 				remove_fleet_flag = GFnyto_shiled_system_LV2_fleet
	# 				remove_fleet_flag = GFnyto_shiled_system_LV1_fleet
	# 				remove_fleet_flag = has_GF_Nyto_T_weapon2
	# 				remove_fleet_flag = loading_fleet_effect
	# 				clear_variable = gf_nyto_damg
	# 			}
	# 			remove_ship_flag = is_Gfnyto_command_ship			
	# 			remove_ship_flag = loading_ship_effect
	# 			remove_modifier = gfnyto_shield_system_sheil_debuff
	# 			remove_modifier = gfnyto_hudun
	# 			remove_modifier = gfnyto_h_weapons2
	# 			remove_modifier = gfnyto_x_weapon2_fire_rate_modifer
	# 			remove_modifier = gfnyto_x_weapon2_weapon_damage_modifer
	# 			remove_modifier = gfnyto_LsScepter_damage_modifer
	# 			remove_modifier = GF_nyoto_shield_ship
	# 			remove_modifier = GF_nyto_l_weapon2_soon	
	# 			remove_modifier = GF_nyto_T_weapon2_damgabuff	
	# 			remove_modifier = GF_nyto_beacon_count_buff
	# 			remove_modifier = GF_nyto_aoe_weapon
	# 		}	
	# 	}
# }

fleet_event = {
	id = gf_nyto_weapons.8001
	hide_window = yes
	trigger = {
		owner = { is_invisable_faction = no }
	}
	is_triggered_only = yes
	immediate = {		
		if = { limit = { is_in_combat = yes }
			set_update_modifiers_batch = begin
			every_owned_ship = {
				change_variable = { which = GF_nyto_combat_days value = 1 }
				fleet = {
					if = {
						limit = { 
							has_fleet_flag = GF_Nyto_m_weapon2_flag
							NOT = { has_fleet_flag = GF_Nyto_m_weapon2_CD_flag }
						}
						set_timed_fleet_flag = { flag = GF_Nyto_m_weapon2_CD_flag days = 20 }
						add_modifier = { modifier = gfnyto_ms_weapons2 days = 8 }
					} #夜空引领者
					if = {
						limit = { 
							has_fleet_flag = GF_Nyto_h_weapon2_flag
							NOT = { has_fleet_flag = GF_Nyto_h_weapon2_CD_flag }
						}
						set_timed_fleet_flag = { flag = GF_Nyto_h_weapon2_CD_flag days = 5 }
						add_modifier = { modifier = gfnyto_h_weapons days = 3 }
					} #戈耳工干扰无人机	
					if = {
						limit = { 
							has_fleet_flag = GF_Nyto_p_weapon1_flag
							prev = {
								check_variable_arithmetic = { modulo = 5 which = GF_nyto_combat_days value = 0 }
							}						
						}
						add_modifier = { modifier = GF_nyto_p_weapon_system days = 2 }
					}#花之锁
				}
				if = {
					limit = { 						
						has_ship_flag = GF_Nyto_p_weapon1_flag
						NOT = { has_ship_flag = GF_Nyto_p_weapon1_CD_flag }				
						check_variable = { which = GF_nyto_combat_days value > 5 }
					}
					set_timed_ship_flag = { flag = GF_Nyto_p_weapon1_CD_flag days = 18 }
					add_modifier = { modifier = gfnyto_light_weapons days = 6 }
				}#光影帷幕
				if = {
					limit = { has_ship_flag = GF_Nyto_l_weapon2_flag  NOT = { has_ship_flag = GF_Nyto_l_weapon2_stop_flag }  }
					export_modifier_to_variable = {
						modifier = weapon_type_energy_weapon_fire_rate_mult
						variable = GF_nyto_son_frt_up
					}
					change_variable = {
						which = GF_nyto_son_frt_up
						value = modifier:weapon_type_son_weapon_fire_rate_mult
					}
					change_variable = {
						which = GF_nyto_son_frt_up
						value = GF_nyto_combat_days
					}
					multiply_variable = {
						which = GF_nyto_son_frt_up
						value = GF_nyto_combat_days
					}
					remove_modifier = GF_nyto_l_weapon2_soon
					if = {
						limit = { check_variable = { which = GF_nyto_son_frt_up value > 100000000 } }
						set_variable = { which = GF_nyto_son_frt_up value = 100000000 }
						set_ship_flag = GF_Nyto_l_weapon2_stop_flag
					}
					add_modifier = { modifier = GF_nyto_l_weapon2_soon 	multiplier = GF_nyto_son_frt_up }
				} # 圣歌风琴
				if = {
					limit = { has_ship_flag = GF_Nyto_T_weapon2_flag }
					set_variable = { which = prism_weapon_speed value = 5 } #基础间隔
					export_modifier_to_variable = {
						modifier = weapon_type_energy_weapon_fire_rate_mult
						variable = prism_weapon_speed_mult
					} #攻速变量
					change_variable = { which = prism_weapon_speed_mult value = modifier:ship_fire_rate_mult } #攻速变量
					change_variable = { which = prism_weapon_speed_mult value = 1 }
					divide_variable = { which = prism_weapon_speed value = prism_weapon_speed_mult }
					round_variable =prism_weapon_speed
					if = { limit = { check_variable = { which = prism_weapon_speed value < 1 }  } set_variable = {  which = prism_weapon_speed  value = 1  } 	}
					if = {
						limit = { 
							check_variable_arithmetic = {
								modulo = prism_weapon_speed
								which = GF_nyto_combat_days
								value = 0
							}
						}
						change_variable = { which = GF_nyto_t_fire_num value = 1 }
						set_variable = { which = GF_nyto_t_damage 	value = GF_nyto_t_fire_num }
						multiply_variable = { which = GF_nyto_t_damage value = GF_nyto_t_fire_num }
						remove_modifier = GF_nyto_T_weapon2_damgabuff
						add_modifier = { modifier = GF_nyto_T_weapon2_damgabuff multiplier = GF_nyto_t_damage  days = -1 }
					}
				}#终末辉光
				# if = {
				# 	limit = { 						
				# 		fleet = { has_fleet_flag = GF_nyto_shield_lv3 }			
				# 		NOT = {
				# 			check_modifier_value = {
				# 				modifier = ship_shield_penetration_mult
				# 				value = -1
				# 			}
				# 		}											
				# 	}					
				# 	export_modifier_to_variable = {
				# 		modifier = ship_shield_penetration_mult
				# 		variable = GF_nyto_shield_penetration
				# 	}
				# 	export_modifier_to_variable = {
				# 		modifier = weapon_type_kinetic_weapon_damage_mult
				# 		variable = GF_nyto_kinetic_damage
				# 	}
				# 	export_modifier_to_variable = {
				# 		modifier = weapon_type_explosive_weapon_damage_mult
				# 		variable = GF_nyto_explosive_damage
				# 	}
				# 	GF_nyto_shield_effect = {
				# 		GF_nyto_penetration_down=1 
				# 		GF_nyto_explosive_up = 1.8
				# 		GF_nyto_kinetic_down = 0.8
				# 	}
				# } else_if = {
				# 	limit = { 
				# 		fleet = {
				# 			has_fleet_flag = GF_nyto_shield_lv2
				# 		}
				# 		NOT = {						
				# 			check_modifier_value = {
				# 				modifier = ship_shield_penetration_mult
				# 				value = -0.8
				# 			}
				# 		}					
				# 	}
				# 	export_modifier_to_variable = {
				# 		modifier = ship_shield_penetration_mult
				# 		variable = GF_nyto_shield_penetration
				# 	}
				# 	export_modifier_to_variable = {
				# 		modifier = weapon_type_kinetic_weapon_damage_mult
				# 		variable = GF_nyto_kinetic_damage
				# 	}
				# 	export_modifier_to_variable = {
				# 		modifier = weapon_type_explosive_weapon_damage_mult
				# 		variable = GF_nyto_explosive_damage
				# 	}
				# 	GF_nyto_shield_effect = {
				# 		GF_nyto_penetration_down= 0.8
				# 		GF_nyto_explosive_up = 1.4
				# 		GF_nyto_kinetic_down = 0.6
				# 	}
				# } else_if = {
				# 	limit = { 
				# 		fleet = {
				# 			has_fleet_flag = GF_nyto_shield_lv1
				# 		}
				# 		NOT = {
				# 			check_modifier_value = {
				# 				modifier = ship_shield_penetration_mult
				# 				value = -0.6
				# 			}
				# 		}					
				# 	}
				# 	export_modifier_to_variable = {
				# 		modifier = ship_shield_penetration_mult
				# 		variable = GF_nyto_shield_penetration
				# 	}
				# 	export_modifier_to_variable = {
				# 		modifier = weapon_type_kinetic_weapon_damage_mult
				# 		variable = GF_nyto_kinetic_damage
				# 	}
				# 	export_modifier_to_variable = {
				# 		modifier = weapon_type_explosive_weapon_damage_mult
				# 		variable = GF_nyto_explosive_damage
				# 	}
				# 	GF_nyto_shield_effect = {
				# 		GF_nyto_penetration_down= 0.6
				# 		GF_nyto_explosive_up = 1.1
				# 		GF_nyto_kinetic_down = 0.4
				# 	}
				# } #立场护盾
				if = {
					limit = {  is_ship_size = GFnyto_shiled_ship }
					export_modifier_to_variable = { modifier = ship_shield_mult 	variable = GF_shield_mult }
					set_variable = { which = GF_shield_regen_mult value = GF_shield_mult }
					multiply_variable = { which = GF_shield_regen_mult value = GF_shield_mult }
					fleet = { 
						remove_modifier = GF_nyoto_shield_ship
						remove_modifier =GF_nyto_shield_ship_regen
						add_modifier = { modifier = GF_nyoto_shield_ship multiplier = prev.GF_shield_mult days = 2 } 
						add_modifier = { modifier = GF_nyto_shield_ship_regen multiplier = prev.GF_shield_regen_mult days = 2 }
					}
				}#立场支援舰
				# if = {
				# 	limit = { 
				# 		has_ship_flag = is_Command_ship
				# 		fleet = { num_ships > 1 }
				# 	}
				# 	fleet = {
				# 		add_modifier = { modifier = gf_nyto_commind_weapon_buff days = 1 }
				# 	}
				# }#指挥舰
				#威廉的预留位				
			}
			set_update_modifiers_batch = end
			fleet_event = { id = gf_nyto_weapons.8001 days = 1 }
		} 
		
		if = { limit = { is_in_combat = no }
			set_update_modifiers_batch = begin
			every_controlled_ship = {
				GF_nyto_remove_effect = yes
			}
			set_update_modifiers_batch = end
		}	
	}
}